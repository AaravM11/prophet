"use client"

import { ShieldAlert, ExternalLink, AlertTriangle, Eye, Zap, Bug, Sparkles } from "lucide-react"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"

export function VulnerabilityReport() {
  return (
    <section className="flex h-full flex-col gap-4 overflow-auto" aria-label="AI vulnerability report">
      {/* Risk Score Card */}
      <Card className="border-neon-red/30 bg-card shadow-[0_0_20px_rgba(255,23,68,0.08)]">
        <CardHeader className="pb-2">
          <div className="flex items-center justify-between">
            <CardTitle className="flex items-center gap-2 text-sm font-medium text-muted-foreground">
              <ShieldAlert className="size-4 text-neon-red" aria-hidden="true" />
              Risk Assessment
            </CardTitle>
            <Badge className="bg-neon-red/15 text-neon-red border-neon-red/30 hover:bg-neon-red/15">
              CRITICAL
            </Badge>
          </div>
        </CardHeader>
        <CardContent>
          <div className="flex items-baseline gap-2">
            <span className="text-5xl font-bold tracking-tight text-neon-red">98</span>
            <span className="text-lg text-muted-foreground">/100</span>
          </div>
          <div className="mt-3 h-2 overflow-hidden rounded-full bg-secondary">
            <div
              className="h-full rounded-full bg-neon-red transition-all"
              style={{ width: "98%" }}
              role="progressbar"
              aria-valuenow={98}
              aria-valuemin={0}
              aria-valuemax={100}
              aria-label="Risk score 98 out of 100"
            />
          </div>
          <p className="mt-2 text-xs text-neon-red/70 font-medium">
            DO NOT DEPLOY - Critical vulnerabilities detected
          </p>
        </CardContent>
      </Card>

      {/* Vulnerability Details */}
      <Card className="flex-1 border-border bg-card">
        <CardHeader className="pb-2">
          <CardTitle className="flex items-center gap-2 text-sm font-medium text-muted-foreground">
            <Bug className="size-4 text-neon-amber" aria-hidden="true" />
            0G AI Analysis Summary
          </CardTitle>
        </CardHeader>
        <CardContent className="flex flex-col gap-3">
          {/* Primary Finding */}
          <div className="rounded-lg border border-neon-red/20 bg-neon-red/5 p-3">
            <div className="flex items-start gap-2">
              <AlertTriangle className="mt-0.5 size-4 shrink-0 text-neon-red" aria-hidden="true" />
              <div>
                <h3 className="text-sm font-semibold text-foreground">Read-Only Reentrancy</h3>
                <p className="mt-1 text-xs text-muted-foreground leading-relaxed">
                  Detected in <code className="rounded bg-secondary px-1.5 py-0.5 text-neon-red font-mono text-[11px]">previewRedeem()</code> function at line 24. The function relies on <code className="rounded bg-secondary px-1.5 py-0.5 font-mono text-[11px] text-foreground">balanceOf()</code> which can be manipulated during a callback in an external protocol integration.
                </p>
              </div>
            </div>
          </div>

          {/* Attack Vector */}
          <div className="rounded-lg border border-border bg-secondary/30 p-3">
            <div className="flex items-start gap-2">
              <Zap className="mt-0.5 size-4 shrink-0 text-neon-amber" aria-hidden="true" />
              <div>
                <h3 className="text-sm font-semibold text-foreground">Attack Vector</h3>
                <p className="mt-1 text-xs text-muted-foreground leading-relaxed">
                  An attacker can exploit the vault via a flash loan, triggering a callback that inflates <code className="rounded bg-secondary px-1.5 py-0.5 font-mono text-[11px] text-foreground">totalAssets</code> during share price calculation, draining the pool.
                </p>
              </div>
            </div>
          </div>

          {/* Impact Summary */}
          <div className="rounded-lg border border-border bg-secondary/30 p-3">
            <div className="flex items-start gap-2">
              <Eye className="mt-0.5 size-4 shrink-0 text-[#00b0ff]" aria-hidden="true" />
              <div>
                <h3 className="text-sm font-semibold text-foreground">Impact Assessment</h3>
                <div className="mt-2 grid grid-cols-2 gap-2 text-xs">
                  <div className="rounded-md bg-secondary/50 px-2.5 py-1.5">
                    <span className="text-muted-foreground">Severity</span>
                    <p className="font-semibold text-neon-red">Critical</p>
                  </div>
                  <div className="rounded-md bg-secondary/50 px-2.5 py-1.5">
                    <span className="text-muted-foreground">Confidence</span>
                    <p className="font-semibold text-neon-amber">97.3%</p>
                  </div>
                  <div className="rounded-md bg-secondary/50 px-2.5 py-1.5">
                    <span className="text-muted-foreground">Category</span>
                    <p className="font-semibold text-foreground">Reentrancy</p>
                  </div>
                  <div className="rounded-md bg-secondary/50 px-2.5 py-1.5">
                    <span className="text-muted-foreground">Est. Loss</span>
                    <p className="font-semibold text-neon-red">$1.5M+</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Action Button */}
          <Button className="mt-1 bg-neon-green/10 text-neon-green border border-neon-green/30 hover:bg-neon-green/20 hover:text-neon-green">
            <Sparkles className="size-4" aria-hidden="true" />
            View AI Patch
            <ExternalLink className="ml-auto size-3.5 opacity-50" aria-hidden="true" />
          </Button>
        </CardContent>
      </Card>
    </section>
  )
}
